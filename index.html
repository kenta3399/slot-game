<!doctype html>
<html lang="th" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN-VIP</title>
    <script src="/_sdk/element_sdk.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            box-sizing: border-box;
            padding-top: 120px;
        }
        
        * {
            font-family: 'Kanit', sans-serif;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(255, 78, 0, 0.4);
            }
            50% {
                box-shadow: 0 0 30px rgba(255, 78, 0, 0.8), 0 0 40px rgba(255, 78, 0, 0.6);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        .game-card {
            animation: slideUp 0.5s ease-out;
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ffc107 100%);
            position: relative !important;
            overflow: hidden;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent
            );
            background-size: 200% 100%;
            animation: shimmer 3s infinite;
        }

        .provider-logo {
            position: absolute !important;
            top: 10px !important;
            left: 10px !important;
            width: 48px !important;
            height: 48px !important;
            z-index: 100 !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            object-fit: cover !important;
            pointer-events: none !important;
            background: transparent !important;
            border-radius: 6px !important;
            padding: 0 !important;
            border: none !important;
        }

        @media (max-width: 768px) {
            .provider-logo {
                width: 30px !important;
                height: 30px !important;
                top: 8px !important;
                left: 8px !important;
                padding: 3px !important;
            }
        }

        @media (min-width: 1024px) {
            .provider-logo {
                width: 30px !important;
                height: 30px !important;
            }
        }

        .game-card:hover .provider-logo {
            transform: scale(1.05) !important;
            transition: transform 0.3s ease !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
        }

        .tab-btn {
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
        }

        .tab-btn.active {
            animation: glow 2s infinite;
        }

        .progress-bar {
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(90deg, #22c55e 0%, #84cc16 50%, #eab308 100%);
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
        }

        .stat-badge {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .refresh-btn:hover {
            transform: scale(1.05);
        }

        .refresh-btn:active {
            transform: scale(0.95);
        }

        .game-icon {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .hidden {
            display: none;
        }

        #login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a2e 100%);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease;
        }

        .login-card {
            background: linear-gradient(135deg, #1f1f1f 0%, #2d2d2d 100%);
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 400px;
            width: 90%;
            border: 2px solid rgba(255, 78, 0, 0.3);
        }

        #main-content {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        #main-content.show {
            opacity: 1;
            pointer-events: auto;
        }

        .progress-container {
            height: 30px;
            min-height: 30px;
            display: flex;
            align-items: center;
        }

        .progress-text {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            z-index: 10;
            line-height: 1 !important;
            pointer-events: none;
        }

        .fixed-navigation {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            z-index: 1000 !important;
            background: linear-gradient(180deg, rgba(10,10,10,0.95) 0%, rgba(26,26,46,0.95) 100%) !important;
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
            padding: 10px 20px !important;
            border-bottom: 1px solid rgba(255, 78, 0, 0.3) !important;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5) !important;
        }

        .fixed-navigation .sticky-container {
            width: 100% !important;
            max-width: 1200px !important;
            margin: 0 auto !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            gap: 15px !important;
        }

        @media (max-width: 768px) {
            body {
                padding-top: 150px;
            }
            
            .fixed-navigation {
                padding: 8px 15px !important;
            }
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .animate-slideIn {
            animation: slideIn 0.3s ease-out forwards;
        }
        
        .animate-slideOut {
            animation: slideOut 0.3s ease-out forwards;
        }
        
        /* Admin notification styles */
        .admin-notification {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9998;
            max-width: 350px;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(10px);
            border-left: 4px solid;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
        }
        
        .admin-notification.info {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        
        .admin-notification.success {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .admin-notification.warning {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }
        
        .admin-notification.error {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }
        
        .admin-notification.urgent {
            border-color: #ff4e00;
            background: rgba(255, 78, 0, 0.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Broadcast overlay styles */
        #broadcast-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        #broadcast-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }
        
        .broadcast-modal {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95) 0%, rgba(10, 10, 10, 0.95) 100%);
            border: 2px solid;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        #broadcast-overlay.show .broadcast-modal {
            transform: scale(1);
        }
        
        .broadcast-modal.info {
            border-color: #3b82f6;
        }
        
        .broadcast-modal.success {
            border-color: #10b981;
        }
        
        .broadcast-modal.warning {
            border-color: #f59e0b;
        }
        
        .broadcast-modal.urgent {
            border-color: #ff4e00;
            animation: pulse 2s infinite;
        }
    </style>
    <style>@view-transition { navigation: auto; }</style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
</head>
<body class="h-full">
    <!-- Login Overlay -->
    <div id="login-overlay">
        <div class="login-card">
            <h1 style="font-size: 32px; font-weight: 800; color: #ff4e00; text-align: center; margin-bottom: 10px;">üîê LOGIN VIP</h1>
            <p style="color: #999; text-align: center; margin-bottom: 30px; font-size: 14px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
            <input type="password" id="pass-field" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" style="width: 100%; padding: 16px; background: rgba(0,0,0,0.4); border: 2px solid rgba(255,78,0,0.3); border-radius: 12px; color: white; font-size: 16px; margin-bottom: 20px; font-family: 'Kanit', sans-serif; outline: none; transition: all 0.3s;" onfocus="this.style.borderColor='#ff4e00'" onblur="this.style.borderColor='rgba(255,78,0,0.3)'" onkeypress="if(event.key==='Enter') handleLogin()">
            <button onclick="handleLogin()" style="width: 100%; padding: 16px; background: linear-gradient(135deg, #ff4e00 0%, #ff6b35 100%); border: none; border-radius: 12px; color: white; font-size: 18px; font-weight: 700; cursor: pointer; transition: all 0.3s; font-family: 'Kanit', sans-serif; box-shadow: 0 4px 15px rgba(255,78,0,0.4);" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">üîì ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
            <p id="error-txt" class="hidden" style="color: #ef4444; text-align: center; margin-top: 15px; font-size: 14px; font-weight: 600;">‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        </div>
    </div>

    <!-- Broadcast Overlay -->
    <div id="broadcast-overlay">
        <div class="broadcast-modal info" id="broadcast-modal">
            <div class="text-center mb-6">
                <div id="broadcast-icon" class="text-5xl mb-4">
                    <i class="fas fa-info-circle text-blue-400"></i>
                </div>
                <h2 id="broadcast-title" class="text-2xl font-bold text-white mb-2">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h2>
                <div id="broadcast-sender" class="text-sm text-gray-400">‡∏à‡∏≤‡∏Å: Admin</div>
            </div>
            
            <div id="broadcast-message" class="text-white text-lg mb-8 text-center">
                ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...
            </div>
            
            <div class="text-center">
                <div class="text-sm text-gray-400 mb-4" id="broadcast-countdown">
                    ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ô <span id="countdown-number">5</span> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                </div>
                <button onclick="closeBroadcast()" class="px-6 py-3 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-white rounded-lg font-bold transition-all duration-300">
                    <i class="fas fa-times mr-2"></i>
                    ‡∏õ‡∏¥‡∏î
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div id="main-content">
        <div class="w-full h-full overflow-auto" style="background: linear-gradient(180deg, #0a0a0a 0%, #1a1a2e 100%);">
            <!-- Navigation Tabs -->
            <div id="navigation-header" class="fixed-navigation">
                <div class="sticky-container">
                    <!-- Navigation Tabs -->
                    <div class="z-50">
                        <div class="flex gap-2 bg-gray-900 p-2.5 rounded-full border border-gray-700 shadow-2xl">
                            <button class="tab-btn active px-6 py-2.5 rounded-full font-bold text-sm transition-all duration-300 bg-gradient-to-r from-orange-500 to-red-600 text-white" onclick="changeTab('pg', this)" id="tab-pg"> PG Soft </button>
                            <button class="tab-btn px-6 py-2.5 rounded-full font-bold text-sm transition-all duration-300 text-gray-400 hover:text-white" onclick="changeTab('pp', this)" id="tab-pp"> Pragmatic </button>
                            <button class="tab-btn px-6 py-2.5 rounded-full font-bold text-sm transition-all duration-300 text-gray-400 hover:text-white" onclick="changeTab('bonus', this)" id="tab-bonus"> Bonus Time </button>
                        </div>
                    </div>
                    
                    <!-- Refresh Button -->
                    <button class="refresh-btn bg-gray-800 text-yellow-400 border-2 border-yellow-400 px-8 py-3 rounded-2xl font-bold text-base transition-all duration-300 hover:bg-yellow-400 hover:text-gray-900 shadow-lg" onclick="renderGames()" id="refresh-btn"> 
                        <i class="fas fa-sync-alt mr-2"></i>
                        ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå 
                    </button>
                    
                    <!-- Admin Connection Status -->
                    <div id="admin-status" class="hidden text-xs px-3 py-1 rounded-full bg-green-900/30 border border-green-700 text-green-400">
                        <i class="fas fa-link mr-1"></i>
                        <span id="connection-status">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Admin</span>
                    </div>
                </div>
            </div>

            <!-- Game Container -->
            <div class="min-h-full flex flex-col items-center p-5 pt-8">
                <div id="game-container" class="w-full max-w-6xl mt-6">
                    <!-- Games will be rendered here -->
                </div>
                
                <!-- System Status Bar -->
                <div id="system-status" class="hidden mt-8 w-full max-w-6xl">
                    <div class="glass-card rounded-xl p-4">
                        <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-orange-500 to-red-600 flex items-center justify-center">
                                    <i class="fas fa-cog"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Admin</h4>
                                    <p class="text-xs text-gray-400">‡∏Ñ‡πà‡∏≤‡∏à‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center gap-6">
                                <div class="text-center">
                                    <p class="text-xs text-gray-400">PG Soft</p>
                                    <p class="text-lg font-bold text-green-400" id="live-pg-value">65%</p>
                                </div>
                                
                                <div class="text-center">
                                    <p class="text-xs text-gray-400">Pragmatic</p>
                                    <p class="text-lg font-bold text-purple-400" id="live-pp-value">60%</p>
                                </div>
                                
                                <div class="text-center">
                                    <p class="text-xs text-gray-400">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
                                    <p class="text-xs text-gray-400" id="last-update-time">--:--:--</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin (‡πÉ‡∏´‡∏°‡πà)
        // ========================================
        
        const VIP_SYSTEM_CONFIG = {
            broadcastChannel: 'vip_admin_broadcast',
            settingsChannel: 'vip_game_settings',
            userChannel: 'vip_user_activity',
            storageKey: 'vip_user_session',
            settingsKey: 'vip_game_settings_data',
            broadcastKey: 'vip_broadcast_messages',
            autoUpdateInterval: 30000, // 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            broadcastDuration: 5000, // 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            reconnectInterval: 5000, // 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            maxBroadcastHistory: 50
        };

        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å Admin (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô)
        let adminSettings = {
            pg: {
                baseWin: 65,
                bonusChance: 25,
                randomness: 15,
                autoMode: false
            },
            pp: {
                baseWin: 60,
                bonusChance: 22,
                volatility: 25,
                rtpMode: 'normal'
            },
            lastUpdated: null,
            version: '1.0.0'
        };

        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
        let userSession = {
            userId: null,
            username: 'user',
            role: 'user',
            loginTime: null,
            lastActivity: null,
            isOnline: false
        };

        // Broadcast messages
        let broadcastMessages = [];
        let activeBroadcast = null;
        let broadcastTimer = null;

        // Broadcast channels
        let broadcastChannel = null;
        let settingsChannel = null;
        let userChannel = null;

        // Connection status
        let isAdminConnected = false;
        let lastConnectionTime = null;
        let connectionAttempts = 0;

        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin
        // ========================================
        
        // ========================================
// ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Vercel)
// ========================================

function initializeAdminConnection() {
    console.log('üîó ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö...');
    
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ shared storage
    setupSharedStorage();
    
    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å storage
    loadSettingsFromStorage();
    
    // ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô user
    registerCurrentUser();
    
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ polling
    startStoragePolling();
    
    setAdminConnected(true);
    console.log('‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
}

function setupSharedStorage() {
    // ‡∏ü‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á settings
    sharedStorage.addListener('settings', (newSettings) => {
        console.log('‚öôÔ∏è ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö settings ‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å storage');
        adminSettings = newSettings;
        renderGames();
        updateConnectionStatus();
        showAdminNotification('‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Admin', 'info');
    });
    
    // ‡∏ü‡∏±‡∏á broadcast ‡πÉ‡∏´‡∏°‡πà
    sharedStorage.addListener('broadcasts', (broadcasts) => {
        const unread = broadcasts?.filter(b => !b.read)?.[0];
        if (unread) {
            handleBroadcastMessage(unread);
            sharedStorage.markBroadcastAsRead(unread.id);
        }
    });
}

function loadSettingsFromStorage() {
    const saved = sharedStorage.get(VIP_SYSTEM_CONFIG.STORAGE_KEYS.SETTINGS);
    if (saved) {
        adminSettings = saved;
    }
    
    // ‡πÇ‡∏´‡∏•‡∏î broadcasts
    const broadcasts = sharedStorage.getUnreadBroadcasts();
    if (broadcasts.length > 0) {
        // ‡πÅ‡∏™‡∏î‡∏á broadcast ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        const latest = broadcasts[0];
        setTimeout(() => {
            handleBroadcastMessage(latest);
            sharedStorage.markBroadcastAsRead(latest.id);
        }, 1000);
    }
}

function registerCurrentUser() {
    const userData = {
        userId: userSession.userId,
        username: 'VIP_User',
        role: 'user',
        page: window.location.href
    };
    
    sharedStorage.registerUser(userData);
}

function startStoragePolling() {
    // Poll ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤
    setInterval(() => {
        if (!isAdminConnected) return;
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö settings ‡πÉ‡∏´‡∏°‡πà
        const saved = sharedStorage.get(VIP_SYSTEM_CONFIG.STORAGE_KEYS.SETTINGS);
        if (saved && JSON.stringify(saved) !== JSON.stringify(adminSettings)) {
            adminSettings = saved;
            renderGames();
            updateConnectionStatus();
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó user activity
        if (userSession.userId) {
            sharedStorage.updateUserActivity(userSession.userId);
        }
        
    }, VIP_SYSTEM_CONFIG.POLL_INTERVAL);
}

// ‡πÉ‡∏ô handleLogin() ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å initializeAdminConnection()
function handleLogin() {
    const passInput = document.getElementById('pass-field').value;
    const correctPass = "224466";

    if (passInput === correctPass) {
        // ... existing login code ...
        
        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
        initializeAdminConnection();
        renderGames();
    }
}

// ‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ô index.html
// let broadcastChannel = null;
// let settingsChannel = null;
// let userChannel = null;
    
    // ‡∏à‡∏≥‡∏•‡∏≠‡∏á Broadcast Messages ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á
    setInterval(() => {
        if (!isAdminConnected || Math.random() > 0.3) return;
        
        const messages = [
            {
                id: 'msg_' + Date.now(),
                type: 'info',
                title: '‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥',
                message: '‡∏£‡∏∞‡∏ö‡∏ö VIP ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏ó‡∏∏‡∏Å‡∏™‡πà‡∏ß‡∏ô',
                sentBy: 'System'
            },
            {
                id: 'msg_' + Date.now(),
                type: 'success',
                title: '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                message: '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                sentBy: 'Auto-System'
            }
        ];
        
        const randomMsg = messages[Math.floor(Math.random() * messages.length)];
        handleBroadcastMessage(randomMsg);
    }, 60000); // ‡∏ó‡∏∏‡∏Å 1 ‡∏ô‡∏≤‡∏ó‡∏µ

// ‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
// let broadcastChannel = null;
// let settingsChannel = null;
// let userChannel = null;

        function setupUserActivity() {
            try {
                userChannel = new BroadcastChannel(VIP_SYSTEM_CONFIG.userChannel);
                
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
                if (userSession.userId) {
                    userChannel.postMessage({
                        type: 'USER_LOGIN',
                        data: {
                            userId: userSession.userId,
                            username: userSession.username,
                            loginTime: new Date().toISOString()
                        }
                    });
                }
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏∏‡∏Å‡∏ô‡∏≤‡∏ó‡∏µ
                setInterval(() => {
                    userSession.lastActivity = new Date().toISOString();
                    saveUserSession();
                }, 60000);
                
            } catch (error) {
                console.error('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ User Activity:', error);
            }
        }

        function setAdminConnected(connected) {
            isAdminConnected = connected;
            
            if (connected) {
                lastConnectionTime = new Date();
                connectionAttempts = 0;
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                document.getElementById('admin-status').classList.remove('hidden');
                document.getElementById('system-status').classList.remove('hidden');
                document.getElementById('connection-status').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Admin';
                document.getElementById('admin-status').className = 'text-xs px-3 py-1 rounded-full bg-green-900/30 border border-green-700 text-green-400';
                
                // ‡∏™‡πà‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                sendUserStatus();
                
            } else {
                connectionAttempts++;
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ UI
                document.getElementById('admin-status').classList.remove('hidden');
                document.getElementById('connection-status').textContent = '‡∏ï‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
                document.getElementById('admin-status').className = 'text-xs px-3 py-1 rounded-full bg-red-900/30 border border-red-700 text-red-400';
                
                // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà
                if (connectionAttempts <= 5) {
                    setTimeout(setupBroadcastChannels, VIP_SYSTEM_CONFIG.reconnectInterval);
                }
            }
            
            updateConnectionStatus();
        }

        function sendUserStatus() {
            try {
                if (userChannel && userSession.userId) {
                    userChannel.postMessage({
                        type: 'USER_STATUS',
                        data: {
                            userId: userSession.userId,
                            username: userSession.username,
                            isOnline: true,
                            lastActivity: new Date().toISOString(),
                            currentTab: currentTab
                        }
                    });
                }
            } catch (error) {
                console.error('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:', error);
            }
        }

        function updateConnectionStatus() {
            const statusEl = document.getElementById('system-status');
            const lastUpdateEl = document.getElementById('last-update-time');
            
            if (isAdminConnected && adminSettings.lastUpdated) {
                const lastUpdate = new Date(adminSettings.lastUpdated);
                lastUpdateEl.textContent = lastUpdate.toLocaleTimeString('th-TH', { 
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit' 
                });
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤ live
                document.getElementById('live-pg-value').textContent = `${adminSettings.pg.baseWin}%`;
                document.getElementById('live-pp-value').textContent = `${adminSettings.pp.baseWin}%`;
            }
        }

        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Broadcast Messages
        // ========================================
        
        function handleBroadcastMessage(broadcast) {
            console.log('üì¢ ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö Broadcast:', broadcast);
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            broadcastMessages.unshift({
                ...broadcast,
                receivedAt: new Date().toISOString(),
                read: false
            });
            
            // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            if (broadcastMessages.length > VIP_SYSTEM_CONFIG.maxBroadcastHistory) {
                broadcastMessages.pop();
            }
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            saveBroadcastHistory();
            
            // ‡πÅ‡∏™‡∏î‡∏á Broadcast ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏¢‡∏π‡πà
            if (!activeBroadcast || activeBroadcast.id !== broadcast.id) {
                showBroadcast(broadcast);
            }
        }

        function showBroadcast(broadcast) {
            const overlay = document.getElementById('broadcast-overlay');
            const modal = document.getElementById('broadcast-modal');
            const title = document.getElementById('broadcast-title');
            const message = document.getElementById('broadcast-message');
            const icon = document.getElementById('broadcast-icon');
            const sender = document.getElementById('broadcast-sender');
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Broadcast
            title.textContent = broadcast.title || '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å Admin';
            message.textContent = broadcast.message || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°';
            sender.textContent = `‡∏à‡∏≤‡∏Å: ${broadcast.sentBy || 'Admin'}`;
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
            const type = broadcast.type || 'info';
            const typeClasses = {
                'info': { icon: 'fa-info-circle', color: 'text-blue-400', modal: 'info' },
                'success': { icon: 'fa-check-circle', color: 'text-green-400', modal: 'success' },
                'warning': { icon: 'fa-exclamation-triangle', color: 'text-yellow-400', modal: 'warning' },
                'urgent': { icon: 'fa-exclamation-circle', color: 'text-red-400', modal: 'urgent' }
            };
            
            const typeConfig = typeClasses[type] || typeClasses.info;
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏µ
            icon.innerHTML = `<i class="fas ${typeConfig.icon} ${typeConfig.color}"></i>`;
            modal.className = `broadcast-modal ${typeConfig.modal}`;
            
            // ‡πÅ‡∏™‡∏î‡∏á Broadcast
            activeBroadcast = broadcast;
            overlay.classList.add('show');
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ timer ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            startBroadcastCountdown(VIP_SYSTEM_CONFIG.broadcastDuration / 1000);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            showAdminNotification(`üì¢ ${broadcast.title || '‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà'}`);
        }

        function closeBroadcast() {
            const overlay = document.getElementById('broadcast-overlay');
            overlay.classList.remove('show');
            
            if (broadcastTimer) {
                clearInterval(broadcastTimer);
                broadcastTimer = null;
            }
            
            activeBroadcast = null;
        }

        function startBroadcastCountdown(seconds) {
            let remaining = seconds;
            const countdownEl = document.getElementById('countdown-number');
            
            if (broadcastTimer) {
                clearInterval(broadcastTimer);
            }
            
            countdownEl.textContent = remaining;
            
            broadcastTimer = setInterval(() => {
                remaining--;
                countdownEl.textContent = remaining;
                
                if (remaining <= 0) {
                    closeBroadcast();
                }
            }, 1000);
        }

        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Game Settings
        // ========================================
        
        function handleGameSettingsUpdate(data) {
            console.log('‚öôÔ∏è ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°:', data);
            
            if (data.game === 'pg' || data.game === 'pp') {
                adminSettings[data.game] = data.settings;
                adminSettings.lastUpdated = new Date().toISOString();
                
                saveAdminSettings();
                renderGames();
                
                showAdminNotification(`‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤ ${data.game === 'pg' ? 'PG Soft' : 'Pragmatic Play'}`);
            }
        }

        function handleValuesUpdated(data) {
            console.log('üìä ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö:', data);
            
            if (data.pg) {
                adminSettings.pg = { ...adminSettings.pg, ...data.pg };
            }
            
            if (data.pp) {
                adminSettings.pp = { ...adminSettings.pp, ...data.pp };
            }
            
            adminSettings.lastUpdated = data.timestamp || new Date().toISOString();
            
            saveAdminSettings();
            renderGames();
            updateConnectionStatus();
        }

        function handleForceRefresh() {
            console.log('üîÑ Admin ‡∏™‡∏±‡πà‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤');
            renderGames();
            showAdminNotification('Admin ‡∏™‡∏±‡πà‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤', 'warning');
        }

        function handleSystemStatus(status) {
            console.log('üìà ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö:', status);
            // ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        }

        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Local Storage
        // ========================================
        
        function loadAdminSettings() {
            try {
                const saved = localStorage.getItem(VIP_SYSTEM_CONFIG.settingsKey);
                if (saved) {
                    const parsed = JSON.parse(saved);
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö version
                    if (parsed.version === adminSettings.version) {
                        adminSettings = parsed;
                        console.log('‚öôÔ∏è ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Admin ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    }
                }
            } catch (error) {
                console.error('‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:', error);
            }
        }

        function saveAdminSettings() {
            try {
                localStorage.setItem(VIP_SYSTEM_CONFIG.settingsKey, JSON.stringify(adminSettings));
            } catch (error) {
                console.error('‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:', error);
            }
        }

        function loadUserSession() {
            try {
                const saved = localStorage.getItem(VIP_SYSTEM_CONFIG.storageKey);
                if (saved) {
                    userSession = JSON.parse(saved);
                    
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á userId ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
                    if (!userSession.userId) {
                        userSession.userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    }
                    
                    userSession.loginTime = new Date().toISOString();
                    userSession.lastActivity = new Date().toISOString();
                    userSession.isOnline = true;
                    
                    saveUserSession();
                } else {
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á session ‡πÉ‡∏´‡∏°‡πà
                    userSession = {
                        userId: 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                        username: 'user',
                        role: 'user',
                        loginTime: new Date().toISOString(),
                        lastActivity: new Date().toISOString(),
                        isOnline: true
                    };
                    
                    saveUserSession();
                }
            } catch (error) {
                console.error('‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î session:', error);
            }
        }

        function saveUserSession() {
            try {
                localStorage.setItem(VIP_SYSTEM_CONFIG.storageKey, JSON.stringify(userSession));
            } catch (error) {
                console.error('‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å session:', error);
            }
        }

        function loadBroadcastHistory() {
            try {
                const saved = localStorage.getItem(VIP_SYSTEM_CONFIG.broadcastKey);
                if (saved) {
                    broadcastMessages = JSON.parse(saved);
                }
            } catch (error) {
                console.error('‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ broadcast:', error);
            }
        }

        function saveBroadcastHistory() {
            try {
                localStorage.setItem(VIP_SYSTEM_CONFIG.broadcastKey, JSON.stringify(broadcastMessages));
            } catch (error) {
                console.error('‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ broadcast:', error);
            }
        }

        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö Admin Notification
        // ========================================
        
        function showAdminNotification(message, type = 'info') {
            // ‡∏•‡∏ö notification ‡πÄ‡∏Å‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
            const oldNotification = document.querySelector('.admin-notification');
            if (oldNotification) {
                oldNotification.remove();
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á notification ‡πÉ‡∏´‡∏°‡πà
            const notification = document.createElement('div');
            notification.className = `admin-notification ${type} animate-slideIn`;
            notification.innerHTML = `
                <div class="flex items-center gap-3">
                    <div class="text-xl">
                        ${type === 'info' ? '‚öôÔ∏è' : 
                          type === 'success' ? '‚úÖ' : 
                          type === 'warning' ? '‚ö†Ô∏è' : 
                          type === 'error' ? '‚ùå' : 
                          type === 'urgent' ? 'üö®' : 'üì¢'}
                    </div>
                    <div class="flex-1">
                        <h4 class="font-bold text-white">Admin System</h4>
                        <p class="text-sm text-gray-300">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // ‡∏•‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.classList.add('animate-slideOut');
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 5000);
        }

        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö Auto Update
        // ========================================
        
        function startAutoUpdate() {
            setInterval(() => {
                if (isAdminConnected) {
                    updateConnectionStatus();
                    sendUserStatus();
                }
            }, VIP_SYSTEM_CONFIG.autoUpdateInterval);
        }

        // ========================================
        // ‡∏£‡∏∞‡∏ö‡∏ö LOGIN ‡πÄ‡∏î‡∏¥‡∏° (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)
        // ========================================
        
        const defaultConfig = {
            title_text: 'Slot Formula VIP',
            refresh_button_text: 'üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå',
            tab_pg_text: 'PG Soft',
            tab_pp_text: 'Pragmatic',
            tab_bonus_text: 'Bonus Time',
            primary_color: '#ff4e00',
            background_color: '#0a0a0a',
            card_gradient_start: '#ff6b35',
            card_gradient_end: '#ffc107',
            text_color: '#ffffff',
            font_family: 'Kanit',
            font_size: 16
        };

        // ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏¢‡πÄ‡∏Å‡∏°
        const pgLogo = "https://i.postimg.cc/wMmKwn72/unna.jpg";
        const ppLogo = "https://i.postimg.cc/T3czNV3M/download.png";

        // ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡πá‡∏ö
        const webNames = {
            1: 'SOZA', 2: 'SNOK', 3: 'KKLOV', 4: 'KKKID', 5: 'KKBOY',
            6: 'FIWFUN', 7: 'MAFINX', 8: 'ZOCOOL', 9: 'OPPA', 10: 'SAATU',
            11: 'FH', 12: 'JKF', 13: 'MXMO', 14: 'SPD',
            15: 'JINGJAI', 16: 'KKMOO', 17: 'LKK', 18: 'SMU', 19: 'LAV'
        };

        // Game data (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
        const gameData = {
            pg: [
                { name: 'Fortune Ox', img: 'https://i.postimg.cc/QtprgBHj/PGS-Fortune-Ox-1702650976.webp', multiplier: 'x5,000' },
                { name: 'Dragon Legend', img: 'https://i.postimg.cc/HL8mxvms/PGS-Dragon-Legend-1702650179.webp', multiplier: 'x10,000' }
                // ... games ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
            ],
            pp: [
                { name: 'Gates of Olympus', img: 'https://i.postimg.cc/wBnbWR2m/PMTS-Duel-of-Night-Day-1763560469.webp', multiplier: 'x5,000' },
                { name: 'Sweet Bonanza', img: 'https://i.postimg.cc/3JL05Xvp/PMTS-Anaconda-Gold-1765796713.webp', multiplier: 'x10,000' }
                // ... games ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
            ],
            bonus: {
                1: [ { img: 'https://i.postimg.cc/qM3pXXvx/107-BC-Bonustime-Soza.jpg' } ],
                2: [ { img: 'https://i.postimg.cc/pXcPCkw4/88-Bc-fak-sasm-snok.jpg' } ]
                // ... bonus images ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
            }
        };

        let currentTab = 'pg';
        let selectedWeb = 1;

        function handleLogin() {
            const passInput = document.getElementById('pass-field').value;
            const correctPass = "224466";

            if (passInput === correctPass) {
                const overlay = document.getElementById('login-overlay');
                const mainContent = document.getElementById('main-content');
                
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.style.display = 'none';
                    mainContent.classList.add('show');
                    
                    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
                    initializeAdminConnection();
                    renderGames();
                }, 500);
            } else {
                const err = document.getElementById('error-txt');
                err.classList.remove('hidden');
                
                document.getElementById('pass-field').value = '';
                document.getElementById('pass-field').focus();
                
                setTimeout(() => {
                    err.classList.add('hidden');
                }, 3000);
            }
        }

        function changeTab(tab, button) {
            currentTab = tab;
            const allButtons = document.querySelectorAll('.tab-btn');
            allButtons.forEach(btn => {
                btn.classList.remove('active', 'bg-gradient-to-r', 'from-orange-500', 'to-red-600', 'text-white');
                btn.classList.add('text-gray-400');
            });
            button.classList.add('active', 'bg-gradient-to-r', 'from-orange-500', 'to-red-600', 'text-white');
            button.classList.remove('text-gray-400');
            renderGames();
            
            // ‡∏™‡πà‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
            sendUserStatus();
        }

        function selectWeb(webNumber) {
            selectedWeb = webNumber;
            renderGames();
        }

        // ========================================
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô renderGames() ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Admin
        // ========================================
        function renderGames() {
            const container = document.getElementById('game-container');
            container.innerHTML = '';
            
            if (currentTab === 'bonus') {
                // ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö
                const webButtonContainer = document.createElement('div');
                webButtonContainer.className = 'mb-8';
                webButtonContainer.innerHTML = '<h3 class="text-2xl font-bold text-white text-center mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö</h3>';
                
                const buttonGrid = document.createElement('div');
                buttonGrid.className = 'grid grid-cols-4 md:grid-cols-5 lg:grid-cols-10 gap-3 p-4';
                
                for (let i = 1; i <= 19; i++) {
                    const webButton = document.createElement('button');
                    webButton.className = `web-btn px-4 py-3 rounded-xl font-bold text-sm md:text-base transition-all duration-300 ${i === selectedWeb ? 'bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-lg scale-105' : 'bg-gray-800 text-gray-300 hover:bg-gray-700'}`;
                    webButton.textContent = webNames[i];
                    webButton.onclick = () => selectWeb(i);
                    buttonGrid.appendChild(webButton);
                }
                
                webButtonContainer.appendChild(buttonGrid);
                container.appendChild(webButtonContainer);
                
                // ‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                const bonusImages = gameData.bonus[selectedWeb] || gameData.bonus[1];
                
                const gridContainer = document.createElement('div');
                gridContainer.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 p-4';
                
                bonusImages.forEach((bonus, index) => {
                    const imageCard = document.createElement('div');
                    imageCard.className = 'rounded-3xl overflow-hidden shadow-2xl bg-gray-900';
                    imageCard.style.animation = 'slideUp 0.5s ease-out';
                    imageCard.style.animationDelay = `${index * 0.1}s`;
                    
                    imageCard.innerHTML = `
                        <img src="${bonus.img}" 
                             alt="Bonus ${index + 1}" 
                             class="w-full h-auto block"
                             crossorigin="anonymous">
                    `;
                    gridContainer.appendChild(imageCard);
                });
                
                container.appendChild(gridContainer);
                return;
            }
            
            const games = gameData[currentTab];
            const gridContainer = document.createElement('div');
            gridContainer.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 p-4';
            
            games.forEach((game, index) => {
                // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Admin ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°
                let baseWin, baseBonus, randomness;
                
                if (currentTab === 'pg') {
                    baseWin = adminSettings.pg.baseWin || 65;
                    baseBonus = adminSettings.pg.bonusChance || 25;
                    randomness = adminSettings.pg.randomness || 15;
                } else if (currentTab === 'pp') {
                    baseWin = adminSettings.pp.baseWin || 60;
                    baseBonus = adminSettings.pp.bonusChance || 22;
                    randomness = adminSettings.pp.volatility || 25;
                } else {
                    baseWin = 65;
                    baseBonus = 25;
                    randomness = 15;
                }
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Admin
                const winVariation = Math.floor(Math.random() * randomness) - (randomness / 2);
                const bonusVariation = Math.floor(Math.random() * 10) - 5;
                
                const winChance = Math.max(30, Math.min(90, baseWin + winVariation));
                const bonusSpecial = Math.max(15, Math.min(50, baseBonus + bonusVariation));
                const multiplier = game.multiplier;
                
                const cardWrapper = document.createElement('div');
                cardWrapper.className = 'flex flex-col';
                const card = document.createElement('div');
                card.className = 'game-card rounded-3xl p-5 shadow-2xl relative mb-3';
                card.style.animationDelay = `${index * 0.1}s`;

                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡∏¢‡πÄ‡∏Å‡∏°
                let providerLogo = "";
                let logoStyle = "";
                let logoClass = "provider-logo";

                if (currentTab === 'pg') {
                    providerLogo = pgLogo;
                    logoStyle = "border: 2px solid #FF6B35 !important;";
                    logoClass = "provider-logo pg-logo";
                } else if (currentTab === 'pp') {
                    providerLogo = ppLogo;
                    logoStyle = "border: 2px solid #FF6B35 !important;";
                    logoClass = "provider-logo pp-logo";
                }

                const logoHTML = providerLogo 
                    ? `<img src="${providerLogo}" 
                         class="${logoClass}" 
                         alt="${currentTab === 'pg' ? 'PG Soft' : 'Pragmatic Play'}"
                         style="${logoStyle}">`
                    : "";

                card.innerHTML = `
                    ${logoHTML}
                    
                    <div class="relative z-10 h-full flex gap-4 items-center p-1">
                        <div class="game-icon w-24 h-32 rounded-2xl border-2 border-white overflow-hidden bg-white flex-shrink-0 shadow-lg self-center">
                            <img src="${game.img}" alt="${game.name}" class="w-full h-full object-cover" crossorigin="anonymous">
                        </div>

                        <div class="flex-1 flex flex-col justify-center relative min-w-0">
                            <div class="absolute -top-1 right-0 text-right opacity-60">
                                <p class="text-[8px] text-white leading-none">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
                                <p class="text-[10px] font-mono text-white">
                                    ${new Date().toLocaleString('th-TH', { 
                                        day: '2-digit', month: '2-digit', year: '2-digit', 
                                        hour: '2-digit', minute: '2-digit' 
                                    })}
                                </p>
                            </div>

                            <div class="pr-10 mb-2">
                                <h2 class="text-xl font-extrabold text-white leading-tight drop-shadow-lg">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏∞</h2>
                                <p class="text-md font-bold text-white drop-shadow-md leading-relaxed break-words">${game.name}</p>
                                <p class="text-[10px] text-white opacity-80">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏£‡∏¥‡∏á</p>
                            </div>

                            <div class="progress-container bg-black bg-opacity-40 rounded-full p-1 mb-3 overflow-hidden w-full max-w-[85%]">
                                <div class="progress-bar h-2.5 rounded-full" style="width: ${winChance}%"></div>
                            </div>

                            <div class="grid grid-cols-3 gap-2">
                                <div class="stat-badge text-center text-white py-1.5 rounded-lg bg-black/30 border border-white/5">
                                    <span class="block text-sm font-bold text-green-300">${winChance}%</span>
                                    <span class="block text-[8px] opacity-80 uppercase">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ä‡∏ô‡∏∞</span>
                                </div>
                                <div class="stat-badge text-center text-white py-1.5 rounded-lg bg-black/30 border border-white/5">
                                    <span class="block text-sm font-bold text-blue-300">${bonusSpecial}%</span>
                                    <span class="block text-[8px] opacity-80 uppercase">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏ü‡∏£‡∏µ</span>
                                </div>
                                <div class="stat-badge text-center text-white py-1.5 rounded-lg bg-black/30 border border-white/5">
                                    <span class="block text-sm font-bold text-yellow-300">${multiplier}</span>
                                    <span class="block text-[8px] opacity-80 uppercase">‡∏ä‡∏ô‡∏∞‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                const copyButton = document.createElement('button');
                copyButton.className = 'copy-card-btn w-full bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 flex items-center justify-center gap-2 border border-gray-700';
                copyButton.innerHTML = '<span><i class="fas fa-copy mr-2"></i>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</span>';
                copyButton.onclick = function() { copyCardAsImage(this); };
                
                cardWrapper.appendChild(card);
                cardWrapper.appendChild(copyButton);
                gridContainer.appendChild(cardWrapper);
            });
            
            container.appendChild(gridContainer);

            setTimeout(() => {
                document.querySelectorAll('.progress-bar').forEach(bar => {
                    bar.style.width = bar.style.width;
                });
            }, 100);
        }

        // ========================================
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÄ‡∏î‡∏¥‡∏°)
        // ========================================
        async function copyCardAsImage(button) {
            const cardWrapper = button.parentElement;
            const card = cardWrapper.querySelector('.game-card');
            const originalHTML = button.innerHTML;
            const originalBackground = button.style.background;
            
            try {
                button.innerHTML = '<span class="text-lg"><i class="fas fa-spinner fa-spin mr-2"></i>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û...</span>';
                button.disabled = true;
                
                const images = card.querySelectorAll('img');
                await Promise.all(Array.from(images).map(img => {
                    if (img.complete) return Promise.resolve();
                    return new Promise((resolve) => {
                        img.crossOrigin = "anonymous";
                        img.onload = resolve;
                        img.onerror = resolve;
                        setTimeout(resolve, 2000);
                    });
                }));

                const canvas = await html2canvas(card, {
                    backgroundColor: '#1a1a1a',
                    scale: 3,
                    useCORS: true,
                    logging: false,
                    onclone: (clonedDoc) => {
                        const clonedCard = clonedDoc.querySelector('.game-card');
                        if (clonedCard) {
                            clonedCard.style.animation = 'none';
                            clonedCard.style.transform = 'none';
                            clonedCard.style.transition = 'none';
                            
                            const style = clonedDoc.createElement('style');
                            style.innerHTML = `
                                .game-card::before { display: none !important; } 
                                * { animation: none !important; transition: none !important; }
                            `;
                            clonedDoc.head.appendChild(style);

                            const progressText = clonedCard.querySelector('.progress-text');
                            if (progressText) {
                                Object.assign(progressText.style, {
                                    display: 'flex', alignItems: 'center', justifyContent: 'center',
                                    position: 'absolute', inset: '0', height: '100%', width: '100%',
                                    lineHeight: '1', margin: '0', transform: 'none'
                                });
                            }
                        }
                    }
                });

                canvas.toBlob(async (blob) => {
                    if (!blob) return;
                    try {
                        if (navigator.clipboard && window.ClipboardItem) {
                            await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);
                            button.innerHTML = '<span class="text-lg"><i class="fas fa-check mr-2"></i>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span>';
                        } else { throw new Error(); }
                    } catch (err) {
                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.download = `slot-vip-${Date.now()}.png`;
                        link.href = url;
                        link.click();
                        button.innerHTML = '<span class="text-lg"><i class="fas fa-download mr-2"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡πâ‡∏ß</span>';
                    }
                    
                    button.style.background = 'rgba(34, 197, 94, 0.4)';
                    setTimeout(() => {
                        button.innerHTML = originalHTML;
                        button.style.background = originalBackground;
                        button.disabled = false;
                    }, 2000);
                    
                }, 'image/png', 1.0);
                
            } catch (error) {
                button.innerHTML = '<span class="text-lg"><i class="fas fa-times mr-2"></i>‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</span>';
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.disabled = false;
                }, 2000);
            }
        }

        // ========================================
        // SDK Integration (‡πÄ‡∏î‡∏¥‡∏°)
        // ========================================
        function onConfigChange(config) {
            const baseSize = config.font_size || defaultConfig.font_size;
            const customFont = config.font_family || defaultConfig.font_family;
            const baseFontStack = 'sans-serif';

            document.getElementById('tab-pg').textContent = config.tab_pg_text || defaultConfig.tab_pg_text;
            document.getElementById('tab-pp').textContent = config.tab_pp_text || defaultConfig.tab_pp_text;
            document.getElementById('tab-bonus').textContent = config.tab_bonus_text || defaultConfig.tab_bonus_text;
            document.getElementById('refresh-btn').textContent = config.refresh_button_text || defaultConfig.refresh_button_text;

            const primaryColor = config.primary_color || defaultConfig.primary_color;
            const activeTab = document.querySelector('.tab-btn.active');
            if (activeTab) {
                activeTab.style.background = `linear-gradient(to right, ${primaryColor}, #dc2626)`;
            }

            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.style.fontFamily = `${customFont}, ${baseFontStack}`;
                btn.style.fontSize = `${baseSize * 0.875}px`;
            });

            document.getElementById('refresh-btn').style.fontFamily = `${customFont}, ${baseFontStack}`;
            document.getElementById('refresh-btn').style.fontSize = `${baseSize}px`;

            document.querySelectorAll('.game-card h2').forEach(el => {
                el.style.fontFamily = `${customFont}, ${baseFontStack}`;
                el.style.fontSize = `${baseSize * 1.5}px`;
            });

            document.querySelectorAll('.game-card p').forEach(el => {
                el.style.fontFamily = `${customFont}, ${baseFontStack}`;
                el.style.fontSize = `${baseSize}px`;
            });
        }

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.primary_color || defaultConfig.primary_color,
                            set: (value) => {
                                config.primary_color = value;
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        },
                        {
                            get: () => config.background_color || defaultConfig.background_color,
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        },
                        {
                            get: () => config.card_gradient_start || defaultConfig.card_gradient_start,
                            set: (value) => {
                                config.card_gradient_start = value;
                                window.elementSdk.setConfig({ card_gradient_start: value });
                            }
                        },
                        {
                            get: () => config.card_gradient_end || defaultConfig.card_gradient_end,
                            set: (value) => {
                                config.card_gradient_end = value;
                                window.elementSdk.setConfig({ card_gradient_end: value });
                            }
                        },
                        {
                            get: () => config.text_color || defaultConfig.text_color,
                            set: (value) => {
                                config.text_color = value;
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: {
                        get: () => config.font_family || defaultConfig.font_family,
                        set: (value) => {
                            config.font_family = value;
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    },
                    fontSizeable: {
                        get: () => config.font_size || defaultConfig.font_size,
                        set: (value) => {
                            config.font_size = value;
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }),
                mapToEditPanelValues: (config) => new Map([
                    ['title_text', config.title_text || defaultConfig.title_text],
                    ['refresh_button_text', config.refresh_button_text || defaultConfig.refresh_button_text],
                    ['tab_pg_text', config.tab_pg_text || defaultConfig.tab_pg_text],
                    ['tab_pp_text', config.tab_pp_text || defaultConfig.tab_pp_text],
                    ['tab_bonus_text', config.tab_bonus_text || defaultConfig.tab_bonus_text]
                ])
            });
        }

        // ========================================
        // Initialize ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        // ========================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ VIP System ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß');
            
            // Focus ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
            const passField = document.getElementById('pass-field');
            if (passField) {
                passField.focus();
            }
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
            passField.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î Broadcast (‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÄ‡∏õ‡πá‡∏ô global)
        window.closeBroadcast = closeBroadcast;
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>